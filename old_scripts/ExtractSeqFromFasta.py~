'''
To extract sequence from any fasta file by giving their ID in a list

Author: Avneesh Kumar
'''
from progressbar import ProgressBar
pbar=ProgressBar()

from os import path
import sys, os, glob
from Bio import SeqIO
from Bio.Seq import Seq
from Bio.SeqRecord import SeqRecord

input_fasta = raw_input('Subject fasta full path:')
ID_list=raw_input('Query ID list full path:')

print ('Reading Subject fasta.... \n')

record_dict = SeqIO.to_dict(SeqIO.parse(input_fasta,'fasta'))

print ('Extracting.... \n')

with open(ID_list) as f:
    lines = f.readlines()
    content = [x.strip() for x in lines]
    i=0
    for i in pbar(range(len(content))):
        id = str(ID_list).split('.')[0]
        id2 = str(ID_list).rsplit('/',1)[0]
        outfile = "%s%s%s%s%s" %(str(id2),str('/'),str(content[i]),str('_'),str(input_fasta).split('/')[-1])
        with open(outfile, 'a') as w_file:
            SeqIO.write((record_dict[content[i]]), w_file,'fasta')# use any record ID
            i +=1